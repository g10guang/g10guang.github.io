<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Begin Jekyll SEO tag v2.4.0 -->
<title>Golang 常用命令 | 刘曦光</title>
<meta name="generator" content="Jekyll v3.7.2" />
<meta property="og:title" content="Golang 常用命令" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="go 基本命令给" />
<meta property="og:description" content="go 基本命令给" />
<link rel="canonical" href="http://g10guang.com/golang/2018/02/05/golang-flequenct-command.html" />
<meta property="og:url" content="http://g10guang.com/golang/2018/02/05/golang-flequenct-command.html" />
<meta property="og:site_name" content="刘曦光" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-02-05T09:00:05+08:00" />
<script type="application/ld+json">
{"description":"go 基本命令给","@type":"BlogPosting","url":"http://g10guang.com/golang/2018/02/05/golang-flequenct-command.html","headline":"Golang 常用命令","dateModified":"2018-02-05T09:00:05+08:00","datePublished":"2018-02-05T09:00:05+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://g10guang.com/golang/2018/02/05/golang-flequenct-command.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  <link rel="stylesheet" href="/assets/main.css">
  <link type="application/atom+xml" rel="alternate" href="http://g10guang.com/feed.xml" title="刘曦光" />
  
</head>


  <body>

    <header class="site-header" role="banner">

  <div class="wrapper">
    
    
    <a class="site-title" rel="author" href="/">刘曦光</a>

    
      <nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
              <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
              <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
          
            
            
          
            
            
            <a class="page-link" href="/about/">About</a>
            
          
            
            
          
            
            
          
            
            
          
        </div>
      </nav>
    
  </div>
</header>


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Golang 常用命令</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2018-02-05T09:00:05+08:00" itemprop="datePublished">
        
        Feb 5, 2018
      </time>
      </p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h1 id="go-基本命令给">go 基本命令给</h1>

<h2 id="go-install">go install</h2>

<p>先编译生成对应的 <code class="highlighter-rouge">.a</code> 文件，然后再移动到 <code class="highlighter-rouge">$GOPATH/pkg</code> 或者 <code class="highlighter-rouge">$GOPATH/bin</code> 目录下</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>go <span class="nb">install</span>
</code></pre></div></div>

<p><code class="highlighter-rouge">-v</code> 参数显示底层执行信息</p>

<h2 id="go-build">go build</h2>

<p>将该包打包为一个 <code class="highlighter-rouge">xxx.a</code> 文件，然后可以被其他包引用</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>go build
</code></pre></div></div>

<p>如果当前包为<code class="highlighter-rouge"><span class="k">package</span> <span class="n">main</span></code>，则将此包打包为一个可运行程序；如果需要在 <code class="highlighter-rouge">$GOPATH/bin</code> 下生成可执行文件，那么需要执行 <code class="highlighter-rouge">go install</code></p>

<p><code class="highlighter-rouge">go build</code> 默认情况下会忽略，<code class="highlighter-rouge">_</code> 和 <code class="highlighter-rouge">.</code> 开头的go文件</p>

<p><strong>go build 参数说明</strong>：</p>

<ul>
  <li><code class="highlighter-rouge">-o-</code> 指定输出的文件名，可以带上路径</li>
  <li><code class="highlighter-rouge">-i</code> 安装相应的包，编译+<code class="highlighter-rouge">go install</code></li>
  <li><code class="highlighter-rouge">-n</code> 把需要执行的命令打印出来，但是不执行，这样可以理解相应命令底层到底做了什么</li>
  <li><code class="highlighter-rouge">-p n</code> 指定并行可运行的编译数量，默认是 CPU 数量</li>
  <li><code class="highlighter-rouge">-a</code> 更新包，对标准包不起作用</li>
  <li><code class="highlighter-rouge">-race</code> 开启编译时自动显示数据竞争情况</li>
  <li><code class="highlighter-rouge">-v</code> 打印我们正在编译的包名</li>
  <li><code class="highlighter-rouge">-work</code> 打印编译时候临时文件夹的名称，如果已经存在就不删除</li>
  <li><code class="highlighter-rouge">-x</code> 打印出编译需要执行的命令，与<code class="highlighter-rouge">-n</code>不同的是 <code class="highlighter-rouge">-x</code> 执行打印输出的命令</li>
  <li><code class="highlighter-rouge">-ccflags 'args list'</code> 传递参数给 5c,6c,8c 调用</li>
  <li><code class="highlighter-rouge">-compile name</code> 指定编译器，<code class="highlighter-rouge">gccgo</code> or <code class="highlighter-rouge">gc</code></li>
  <li><code class="highlighter-rouge">-gcflags 'args list'</code> 传递参数给 5g,6g,8g</li>
  <li><code class="highlighter-rouge">-installsuffix suffix</code> 为了和安装包区分开来</li>
  <li><code class="highlighter-rouge">-ldflags 'args list'</code> 传递参数给 5l,6l,8l</li>
  <li><code class="highlighter-rouge">-tags 'tags list'</code> 设置在编译时候可以适配的那些 tag</li>
</ul>

<p>如果代码需要执行某些跨平台的操作，那么可以使用 <code class="highlighter-rouge">xxxx_linux.go</code> <code class="highlighter-rouge">xxxx_darwin.go</code> <code class="highlighter-rouge">xxxx_windows.go</code> 等命名，执行 go 命令只会采用以 <code class="highlighter-rouge">_platform</code> 当前系统名称结尾的文件</p>

<h2 id="go-get">go get</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>go get <span class="nt">-u</span> github.com/g10guang/xxxxx
</code></pre></div></div>

<p>-u 参数可以自动更新包，而且 go get 的时候会自动获取第三方依赖</p>

<p>目录结构：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$GOPATH
    src
        |-github.com
            |-g10guang
                |-xxxx
    pkg
        |-github.com
            |-g10guang
                |xxxx.a
</code></pre></div></div>

<p>go get 本质上可以理解为先把远程代码 <code class="highlighter-rouge">fetch</code> 下来，然后执行 <code class="highlighter-rouge">go install</code></p>

<p><strong>参数说明：</strong></p>

<ul>
  <li><code class="highlighter-rouge">-d</code> 只下载不安装</li>
  <li><code class="highlighter-rouge">-v</code> 显示执行的命令</li>
  <li><code class="highlighter-rouge">-u</code> 强制使用网络去更新包和它的依赖包</li>
  <li><code class="highlighter-rouge">-t</code> 下载测试所需要的包</li>
  <li><code class="highlighter-rouge">-fix</code> 在获取源码之后，先运行 fix，然后再去做其他事</li>
  <li><code class="highlighter-rouge">-f</code> 只有包含了 <code class="highlighter-rouge">-u</code> 参数时才生效，不去验证每一个 import 是否已经获取了，对于本地 fork 的包特别有效</li>
</ul>

<h2 id="go-clean">go clean</h2>

<p>删除当前源码包和关联源码包里面编译生成的文件</p>

<p><strong>参数说明：</strong></p>

<ul>
  <li><code class="highlighter-rouge">-i</code> 清除关联的安装的包和可运行文件，也就是通过 <code class="highlighter-rouge">go install</code> 生成的文件</li>
  <li><code class="highlighter-rouge">-n</code> 打印执行的相应命令，但是不执行</li>
  <li><code class="highlighter-rouge">-r</code> 循环清除 import 中引入的包</li>
  <li><code class="highlighter-rouge">-x</code> 输出执行的命令，并且执行</li>
</ul>

<h2 id="go-fmt">go fmt</h2>

<p>格式化 go 代码，也就是 vscode 失去焦点后自动执行的命令，这样可以保证一个团队中代码风格统一</p>

<p><strong>参数说明：</strong></p>

<ul>
  <li><code class="highlighter-rouge">-l</code> 显示需要格式化的文件</li>
  <li><code class="highlighter-rouge">-w</code> 将格式化的结果输出到文件，而不是打印输出，如果不带该参数最终结果将不会输出到文件</li>
  <li><code class="highlighter-rouge">-r</code> 添加重写规则，方便做批量替换</li>
  <li><code class="highlighter-rouge">-s</code> 简化文件中的代码</li>
  <li><code class="highlighter-rouge">-d</code> 显示格式户前后的 diff，而不写入文件</li>
  <li><code class="highlighter-rouge">-e</code> 打印所有的语法错误到控制台</li>
  <li><code class="highlighter-rouge">-cpuprofile</code> 支持调试模式，写入相应的 <code class="highlighter-rouge">cpufile</code> 到指定文件</li>
</ul>

<h2 id="go-test">go test</h2>

<p>读取源码目录下的 <code class="highlighter-rouge">*_test.go</code> 文件，执行测试用例</p>

<p><strong>参数说明：</strong></p>

<ul>
  <li><code class="highlighter-rouge">-bench regexp</code> 执行相应的 benchmark，例如 <code class="highlighter-rouge">-bench=.</code></li>
  <li><code class="highlighter-rouge">-cover</code> 开启测试覆盖率</li>
  <li><code class="highlighter-rouge">-run regexp</code> 只运行匹配正则 regexp 的函数，例如 <code class="highlighter-rouge">-run=Array</code> 只运行所有以 Array 开头的函数</li>
  <li><code class="highlighter-rouge">-v</code> 显示测试的详细命令</li>
</ul>

<h2 id="go-tool">go tool</h2>

<p>go tool 下聚集了很多命令，比如 <code class="highlighter-rouge">fix</code> <code class="highlighter-rouge">vet</code></p>

<ul>
  <li><code class="highlighter-rouge">go tool fix</code> 用来修复老版本的代码到新版本，自动修改变化的 API</li>
  <li><code class="highlighter-rouge">go tool vet directories | files</code> 分析代码的语法是否正确，比如检查 <code class="highlighter-rouge">fmt.Printf()</code> 中的参数是否正确，<code class="highlighter-rouge">return</code> 之后是否还有多余的代码</li>
</ul>

<h2 id="go-generate">go generate</h2>

<p>用来在编译前生成某些代码，是通过分析源码中特殊的注释，判断需要生成某些特殊代码</p>

<p><code class="highlighter-rouge">go generate</code> 是给当前包的开发人员使用的，而不是给使用该包的人使用的</p>

<p>比如我们经常使用 <code class="highlighter-rouge">yacc</code> 生成代码</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>go tool yacc <span class="nt">-o</span> gopher.go <span class="nt">-p</span> parser gopher.y
</code></pre></div></div>

<p>如果我们想让 <code class="highlighter-rouge">go generate</code> 替我们执行该命令，那么可以在代码中任意一个位置插入注释：</p>

<div class="language-golang highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">//go:generate go tool yacc -o gopher.go -p parser gopher.y</span><span class="x">
</span></code></pre></div></div>

<p>在编译时候执行：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>go generate
go build
</code></pre></div></div>

<h2 id="godoc">godoc</h2>

<p>查看文档的命令，安装 godoc：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>go get golang.org/x/tools/cmd/godoc
</code></pre></div></div>

<p>比如查看 <code class="highlighter-rouge">net/http</code> 包的使用文档可以执行：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>godoc net/http
</code></pre></div></div>

<p>查看某个函数文档：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>godoc <span class="nb">fmt </span>Printf
</code></pre></div></div>

<p>查看函数源码：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>godoc <span class="nt">-src</span> <span class="nb">fmt </span>Printf
</code></pre></div></div>

<p>本地运行 golang.org 站点中的文档，运行在特定端口上：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>godoc <span class="nt">-http</span><span class="o">=</span>:8080
</code></pre></div></div>

<p>我们可以在浏览器查看 <code class="highlighter-rouge">127.0.0.1:8080</code> 查看文档</p>

<h2 id="go-version">go version</h2>

<p>查看当前 go 版本</p>

<h2 id="go-env">go env</h2>

<p>查看当前 go 的环境变量</p>

<h2 id="go-list">go list</h2>

<p>列出当前包正在使用的包</p>

<h2 id="go-run">go run</h2>

<p>编译并运行 go 程序</p>

<h2 id="go-help-cmd">go help cmd</h2>

<p>查看某条命令的帮助文档</p>

  </div>

  

  <a class="u-url" href="/golang/2018/02/05/golang-flequenct-command.html" hidden></a>
</article>

      </div>
    </main>

    <footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">刘曦光</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">
            
              刘曦光
            
            </li>
            
            <li><a class="u-email" href="mailto:g10guang@foxmail.com">g10guang@foxmail.com</a></li>
            
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
  
  
  
  <li><a href="https://github.com/g10guang"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">g10guang</span></a></li>
  
  
  
  
  
  
  
</ul>

      </div>

      <div class="footer-col footer-col-3">
        <p>我会在这里分享我的成长经历、心得，既有IT方面的，也有生活读书方面的。</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
